<%- include('./partials/header'); %>


    <!-- Sales Chart Start -->
    <div class="container-fluid pt-4 px-4">
        <div class="row g-4">
            <div class="col-sm-12 col-xl-8">
                <div class="bg-light text-center rounded p-4">
                    <div class="d-flex align-items-center justify-content-between mb-4">
                        <h6 class="mb-0">Sales and Orders</h6>

                    </div>
                    <canvas id="worldwide-sales"></canvas>
                </div>
            </div>
            <!-- <div class="col-sm-12 col-xl-6">
                <div class="bg-light text-center rounded p-4">
                    <div class="d-flex align-items-center justify-content-between mb-4">
                        <h6 class="mb-0">User count</h6>

                    </div>
                    <canvas id="salse-revenue"></canvas>
                </div>
            </div> -->
        </div>
    </div>
    <!-- Sales Chart End -->



    <!-- Widgets Start -->
    <div class="container-fluid pt-4 px-4">
        <div class="row g-4">

            <div class="col-sm-12 col-md-6 col-xl-4">
                <div class="h-100 bg-light rounded p-4">
                    <div class="d-flex align-items-center justify-content-between mb-2">
                        <h6 class="mb-0">Top <%=limit%> Best Selling Products</h6>
                    </div>
                    <% for(let i=0;i<limit;i++){%>
                        <div class="d-flex align-items-center border-bottom py-3">
                            <P>
                                <strong>
                                    <%=parseInt(`${i+1}`)%>
                                </strong> - <%=product[i]%>
                            </P>
                        </div>
                        <%}%>

                </div>
            </div>

            <div class="col-sm-12 col-md-6 col-xl-4">
                <div class="h-100 bg-light rounded p-4">
                    <div class="d-flex align-items-center justify-content-between mb-2">
                        <h6 class="mb-0">Top <%=limit%> Best Selling Categorys</h6>
                    </div>
                    <% for(let i=0;i<limit;i++){%>
                        <div class="d-flex align-items-center border-bottom py-3">
                            <P>
                                <strong>
                                    <%=parseInt(`${i+1}`)%>
                                </strong> - <%=catagory[i]?.name%>
                            </P>
                        </div>
                        <%}%>

                </div>
            </div>

            <div class="col-sm-12 col-md-6 col-xl-4">
                <div class="h-100 bg-light rounded p-4">
                    <div class="d-flex align-items-center justify-content-between mb-2">
                        <h6 class="mb-0">Top <%=limit%> Best Selling Brands</h6>
                    </div>
                    <% for(let i=0;i<limit;i++){%>
                        <div class="d-flex align-items-center border-bottom py-3">
                            <P>
                                <strong>
                                    <%=parseInt(`${i+1}`)%>
                                </strong> - <%=brand[i]?.name%>
                            </P>
                        </div>
                        <%}%>

                </div>
            </div>

        </div>
    </div>
    <!-- Widgets End -->


    <%- include('./partials/footer'); %>

        <script>
            let monthlySales, productsPerMonth;
            fetch('/admin/api/sales-report').then((response) => {
                return response.json()
            }).then((data) => {
                // alert(data)
                // console.log(data)
                monthlySales = data.monthlySalesArray;
                productsPerMonth = data.productsPerMonth;
                var ctx1 = $("#worldwide-sales").get(0).getContext("2d");
                var myChart1 = new Chart(ctx1, {
                    type: "bar",
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                        datasets: [{
                            label: "monthly",
                            data: monthlySales,
                            backgroundColor: "rgba(0, 156, 255, .7)",
                            fill: true,
                        },
                        {
                            label: "yearly",
                            data: productsPerMonth,
                            backgroundColor: "rgba(0, 156, 255, .5)",
                            fill: true
                        },
                        ]
                    },
                    options: {
                        responsive: true
                    }
                });
            }).catch((err) => {
                alert(err)
            })
            // Worldwide Sales Chart
        </script>