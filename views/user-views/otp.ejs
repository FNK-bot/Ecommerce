<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OTP</title>
  <!--Google Fonts and Icons-->
  <link
    href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined|Material+Icons+Round|Material+Icons+Sharp|Material+Icons+Two+Tone"
    rel="stylesheet" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Foldit:wght@100;200;300;400;500;600;700;800;900&display=swap"
    rel="stylesheet" />
</head>
<style>
  body {
    width: 100%;
    height: 100vh;
    margin: 0;
    padding: 0;
  }

  .center {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgb(244, 254, 232);
  }

  form {
    width: 450px;
    height: 320px;
    border-radius: 3mm;
    border: 0.4mm solid rgb(28, 58, 64);
    background: rgb(255, 255, 255);
    padding: 20px;
    box-sizing: border-box;
    display: flex;
    align-items: flex-start;
    justify-content: center;
    flex-direction: column;
    position: relative;
    box-shadow: rgba(50, 50, 93, 0.25) 0px 6px 12px -2px,
      rgba(0, 0, 0, 0.3) 0px 3px 7px -3px;
  }

  .icon {
    width: 100%;
    margin-bottom: 10px;
  }

  .icon span {
    font-size: 40px;
    color: rgb(233, 126, 81);
  }

  .head {
    width: 100%;
  }

  .title {
    font-family: poppins;
    font-size: 20px;
    color: rgb(28, 58, 64);
    font-weight: 500;
    margin-bottom: 3px;
  }

  .subtitle {
    font-family: poppins;
    font-size: 13px;
    color: rgb(98, 98, 98);
  }

  .input-fields {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    flex-grow: 1;
  }

  .inputs {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: space-evenly;
  }

  .inputs input {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: none;
    outline: 0.4mm solid rgba(28, 58, 64, 0.7);
    text-align: center;
    font-family: poppins;
    background: white;
    font-size: 18px;
  }

  .inputs input:focus {
    outline: 0.4mm solid rgba(130, 190, 87);
  }

  .inputs input:valid {
    background: rgb(130, 190, 87);
    color: white;
    outline: 0.4mm solid rgb(130, 190, 87);
  }

  .timer {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: poppins;
    font-size: 14px;
    color: rgb(98, 98, 98);
    margin: 10px 0;
  }

  .timer button {
    background: none;
    outline: none;
    border: none;
    color: rgb(98, 98, 98);
    font-family: poppins;
    text-decoration: underline;
    cursor: pointer;
  }

  .timer button:disabled {
    color: rgb(200, 200, 200);
    cursor: auto;
  }

  .timer .time {
    width: 30px;
  }

  .btn {
    width: 100%;
    background: rgb(28, 58, 64);
    color: white;
    padding: 5px 0;
    font-family: poppins;
    font-size: 16px;
    border-radius: 1mm;
    cursor: pointer;
  }

  .status {
    position: absolute;
    width: 0;
    height: 100%;
    top: 0;
    left: 0;
    background: rgb(28, 58, 64);
    border-radius: 2mm;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    overflow: hidden;
    transition: 0.35s;
  }

  .status span {
    font-size: 80px;
    width: 80px;
    color: rgb(249, 244, 60);
  }

  .success {
    color: white;
  }


  .noaccees {
    color: black;
    display: flex;
    text-align: center;
    align-items: center;
    justify-content: center;
    margin-top: 50px;
  }

  /* Media Queries for Responsive Design */
  @media (max-width: 768px) {
    form {
      max-width: 400px;
      padding: 15px;
    }

    .inputs input {
      width: 35px;
      height: 35px;
      font-size: 16px;
    }

    .btn {
      font-size: 14px;
      padding: 8px 0;
    }

    .title {
      font-size: 18px;
    }

    .subtitle {
      font-size: 12px;
    }


  }

  @media (max-width: 480px) {
    form {
      max-width: 350px;
      padding: 10px;
    }

    .inputs input {
      width: 30px;
      height: 30px;
      font-size: 14px;
    }

    .btn {
      font-size: 12px;
      padding: 6px 0;
    }

    .title {
      font-size: 16px;
    }

    .subtitle {
      font-size: 10px;
    }
  }
</style>

<body>
  <%if(email!=undefined){%>
    <div class="center">
      <form action="/otp" method="post">
        <div class="icon">
          <img src="/img/core-img/logo.png" alt="logo" width="100">
        </div>
        <div class="head">
          <%if(!message){%>
            <div class="title" id="title">Please check your email</div>
            <div class="subtitle" id="subtitle">We've sent a OTP to <%=email%>
            </div>
            <%}else{%>
              <div class="title">
                <%=message%>
              </div>
              <div class="subtitle" id="subtitle">Re-Check the Otp shared In Your Gmail <%=email%>
              </div>
              <%}%>
        </div>
        <span class="input-fields">
          <span class="inputs">
            <input type="text" class="input" required pattern="[0-9]*" maxlength="1" name="one" />
            <input type="text" class="input" required pattern="[0-9]*" maxlength="1" name="two" />
            <input type="text" class="input" required pattern="[0-9]*" maxlength="1" name="three" />
            <input type="text" class="input" required pattern="[0-9]*" maxlength="1" name="four" />

          </span>
          <div class="timer">
            Didn't recieve code
            <button type="button" id="resend">Click to Resend</button>
            <span class="time"></span>
          </div>
        </span>
        <button type="submit" class="btn">Submit</button>

        <div class="status" id="status">
          <span class="material-icons"> done_outlined </span>
          <div class="title success">Hooray!</div>
          <div class="subtitle success">Verification Successful</div>
        </div>
      </form>
    </div>
    <script>
      let message = document.getElementById('subtitle');

      function timer(n) {
        document.getElementById("resend").disabled = true;
        const interval = setInterval(() => {
          if (n == 0) {
            clearInterval(interval);
            document.getElementById("resend").disabled = false;
          }
          document.querySelector(".time").innerHTML = n;
          n = n - 1;
        }, 1000);
      }
      timer(15);
      document.getElementById("resend").onclick = function () {
        timer(15);
        document.getElementById('title').innerText = 'OTP Resended'
        message.innerText = "We've sent a new OTP to <%=email%>";
        fetch("/resendOtp", {
          method: "POST",
          body: JSON.stringify({
            email: '<%=email%>'
          }),
          headers: {
            "Content-type": "application/json; charset=UTF-8"
          }
        });
      };

      let inputs = document.querySelectorAll(".input");
      inputs.forEach((input) => {
        input.addEventListener("keyup", (e) => {
          let key = e.key;
          if (Number.isInteger(Number(key))) {
            if (input.nextElementSibling) {
              input.nextElementSibling.focus();
            }
          }
        });

        input.addEventListener("keydown", (e) => {
          let key = e.key;
          if (input.value == "" && key === "Backspace") {
            if (input.previousElementSibling) {
              input.previousElementSibling.focus();
            }
          }
        });
      });

      // document.querySelector(".btn").onclick = function () {
      //   document.getElementById("status").style.width = "100%";
      // };
    </script>
    <%}else{%>

      <marquee behavior="" direction="left" loop="" bgcolor="skyblue">This page Only for Email Verification
        while
        registering new
        user </marquee>
      <div class="noaccees">
        <h1>No acces For this page</h1>

      </div>
      <%}%>

</body>

</html>